<!DOCTYPE html>
<html lang="de">

<head>
    <!-- Meta -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Link -->
    <link rel="stylesheet" href="style.css" />
    <script src="script.js" defer></script>
    <script src="./js/login.js" defer></script>
    <script src="./js/firebase.js" defer></script>
    <script src="./assets/templates/load_header_sidebar.js"></script>
    <link rel="stylesheet" href="./assets/fonts/font.css" />
    <link rel="stylesheet" href="./styles/side_header_template.css" />
    <link rel="stylesheet" href="./styles/summary.css">
    <!-- Link-Fonts -->
    <link rel="stylesheet" href="./assets/fonts/font.css" />
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./assets/img/favicon.svg" />
    <!-- Title -->
    <title>Summary</title>

    <style>
        
    </style>
</head>

<body>

    <div id="sidebar-placeholder"></div>
    <div id="mobile-nav-placeholder"></div> <!-- Neuer Platzhalter für mobile Navbar -->
    <div id="header-placeholder"></div>

    <div class="title-container">
        <h1>Join 360</h1>
        <span class="separator"></span>
        <p>Key Metrics at a Glance</p>
    </div>
    <div class="main-summary">
        <div class="summary-conatiner">
            <div class="toDo-done-container">
                <div class="toDo-container">
                    <div class="image-todo-container">
                        <img src="./assets/img/edit_todo.svg" alt="">
                    </div>
                    <div class="toDo-number-container">
                        <span class="todo-number">1</span>
                        <span class="summary-span">To do</span>
                    </div>
                </div>
                <div class="done-container">
                    <div class="image-done-container">
                        <img src="./assets/img/ok_done.svg" alt="">
                    </div>
                    <div class="done-number-container">
                        <span class="done-number">2</span>
                        <span class="summary-span">Done</span>
                    </div>
                </div>
            </div>
            <div class="urgent-date-container">
                <div class="urgent-container">
                    <div>
                        <img src="./assets/img/urgent.svg" alt="">
                    </div>
                    <div class="urgent-number-container">
                        <span class="urgent-number"> 0</span>
                        <span class="summary-span"> Urgent </span>
                    </div>
                </div>
                <span class="separator-urgent"></span>
                <div class="data-container">
                    <span class="date-urgent" id="datum"></span>
                    <span class="Upcoming-Deadline">Upcoming Deadline </span>
                </div>
            </div>
            <div class="tasks-container">
                <div class="board-task-container">
                    <div class="board-number-span">
                        <span class="board-number">5</span>
                        <span class="tasks-span"> Tasks in<br>board </span>
                    </div>
                </div>
                <div class="progress-task-container">
                    <div class="progress-number-span">
                        <span class="progress-number">4</span>
                        <span class="tasks-span"> Tasks in<br>Progress </span>
                    </div>
                </div>
                <div class="feedback-task-container">
                    <div class="feedback-number-span">
                        <span class="feedback-number">2</span>
                        <span class="tasks-span"> Awaiting Feedback </span>
                    </div>
                </div>
            </div>
        </div>
        <div class="main-greet">
            <div class="greet-container">
                <span class="greet-time">Good morning, </span>
                <span id="greetUser" class="greet-name">Sofia Müller</span>
            </div>
        </div>
    </div>

    <script>
        /////Beim Laden der Seite den  Benutzernamen aus dem LocalStorage auslesen und im Begrüßungselement mit entsrpechender Begrüßung anzeigen////////////////////////////////////////////////////////////////////////////////////
        document.addEventListener('DOMContentLoaded', function () {
            // Überprüfen, ob ein Benutzer im localStorage gespeichert ist
            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));

            if (loggedInUser && loggedInUser.name) {
                // Benutzernamen anzeigen
                document.getElementById('greetUser').textContent = loggedInUser.name;
            } else {
                // Falls kein Benutzer eingeloggt ist, Weiterleitung zur Login-Seite
                // muss wieder aktiviert werden --> window.location.href = 'index.html';
            }
        });

        function getGreeting() {
            const hour = new Date().getHours();
            if (hour < 12) {
                return 'Good morning,';
            } else if (hour < 18) {
                return 'Good afternoon,';
            } else {
                return 'Good evening,';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            // ... Ihr bestehender Code ...

            // Begrüßung setzen
            document.querySelector('.greet-time').textContent = getGreeting();
             // Lade die Anzahl der "Urgent"-Aufgaben und das nächste Fälligkeitsdatum
            const urgentCount = localStorage.getItem("urgentCount") || 0;
            const nearestDeadline = localStorage.getItem("nearestDeadline") || "No upcoming deadline";

            // Zeige die Anzahl der "Urgent"-Aufgaben an
            document.querySelector(".urgent-number").innerText = urgentCount;

            // Zeige das nächste Fälligkeitsdatum an
            document.getElementById("datum").innerText = nearestDeadline ? new Date(nearestDeadline).toLocaleDateString('de-DE') : "Keine Frist";
        });

        /////////////////////////////////////////////////////////////////////////////////////////
        // Datum //
        const heute = new Date();

        const options = { year: 'numeric', month: 'long', day: 'numeric' };

        const formatiertesDatum = heute.toLocaleDateString('en-US', options);

        document.getElementById('datum').innerText = formatiertesDatum;
        // Datum //

        // Redirect to 'board.html' when containers are clicked
        document.querySelector('.toDo-container').addEventListener('click', function () {
            window.location.href = 'board.html';
        });

        document.querySelector('.done-container').addEventListener('click', function () {
            window.location.href = 'board.html';
        });

        document.querySelector('.urgent-date-container').addEventListener('click', function () {
            window.location.href = 'board.html';
        });

        document.querySelector('.board-task-container').addEventListener('click', function () {
            window.location.href = 'board.html';
        });

        document.querySelector('.progress-task-container').addEventListener('click', function () {
            window.location.href = 'board.html';
        });

        document.querySelector('.feedback-task-container').addEventListener('click', function () {
            window.location.href = 'board.html';
        });

        // Drag-Area zähler //
        document.addEventListener("DOMContentLoaded", function () {
            const todoCount = localStorage.getItem('todoCount') || 0; // Für Todo
            document.querySelector(".todo-number").innerText = todoCount;

            const doneCount = localStorage.getItem('doneCount') || 0; // Für Done
            document.querySelector(".done-number").innerText = doneCount;

            const boardTaskCount = localStorage.getItem('boardTaskCount') || 0; // Gesamtzahl 
            document.querySelector(".board-number").innerText = boardTaskCount;

            const inProgressCount = localStorage.getItem('inProgressCount') || 0; // In Progress
            document.querySelector(".progress-number").innerText = inProgressCount;

            const feedbackCount = localStorage.getItem('feedbackCount') || 0; // Await Feedback
            document.querySelector(".feedback-number").innerText = feedbackCount;
        });
    </script>
</body>

</html>